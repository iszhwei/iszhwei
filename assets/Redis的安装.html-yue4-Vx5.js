import{_ as l}from"./plugin-vue_export-helper-x3n3nnut.js";import{r as i,o,c as p,d as s,e as n,f as c,w as r,a}from"./app-mYdPlPhZ.js";const t="/assets/image-20240503153158588-mtD0FWse.png",d="/assets/image-20240503155914895-TcKkWyDT.png",y="/assets/image-20240503160050654--Ovv9wpR.png",v="/assets/image-20240503161755320-m57fzyJa.png",u="/assets/image-20240503163057169-p_TToHV0.png",B={},m=a(`<h1 id="redis的安装" tabindex="-1"><a class="header-anchor" href="#redis的安装" aria-hidden="true">#</a> Redis的安装</h1><h2 id="redis的安装-1" tabindex="-1"><a class="header-anchor" href="#redis的安装-1" aria-hidden="true">#</a> Redis的安装</h2><ol><li><p>redis官网上下载最新安装包到家目录</p></li><li><p>解压压缩包，然后会在家目录下面生成一个对应文件夹redis-6.0.8。</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="shiki one-dark-pro" style="background-color:#282c34;" tabindex="0"><code><span class="line"><span style="color:#61AFEF;">tar</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">zxvf</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">redis-6.0.8.tar.gz</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></li><li><p>进入到解压后的目录redis-6.0.8，然后执行make</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="shiki one-dark-pro" style="background-color:#282c34;" tabindex="0"><code><span class="line"><span style="color:#56B6C2;">cd</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">redis-6.0.8</span></span>
<span class="line"><span style="color:#61AFEF;">make</span></span>
<span class="line"><span style="color:#61AFEF;">sudo</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">make</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">install</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>进入utils目录</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="shiki one-dark-pro" style="background-color:#282c34;" tabindex="0"><code><span class="line"><span style="color:#56B6C2;">cd</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">utils</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>接着进入到<code>install_server.sh</code>文件，注释掉下面的内容（大于在77行，有8行，shell的注释是以<code>#</code>进行的注释）</p><figure><img src="`+t+`" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>注释之后，保存退出并且执行下面命令</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="shiki one-dark-pro" style="background-color:#282c34;" tabindex="0"><code><span class="line"><span style="color:#61AFEF;">sudo</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">./install_server.sh</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><figure><img src="`+d+'" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure></li></ol><figure><img src="'+y+`" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><ul><li>可以看到，安装完之后redis server已启动，默认监听6379</li></ul><p>执行<code>redis-server</code>即可启动redis服务器（默认端口6379）</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="shiki one-dark-pro" style="background-color:#282c34;" tabindex="0"><code><span class="line"><span style="color:#61AFEF;">redis-server</span><span style="color:#ABB2BF;"> </span><span style="color:#7F848E;font-style:italic;">#启动redis服务器6379</span></span>
<span class="line"><span style="color:#61AFEF;">redis-server</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">--port</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">8989</span><span style="color:#ABB2BF;"> </span><span style="color:#7F848E;font-style:italic;">#切换8989端口启动redis</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;">redis-cli</span><span style="color:#ABB2BF;"> </span><span style="color:#7F848E;font-style:italic;">#默认连接6379</span></span>
<span class="line"><span style="color:#61AFEF;">redis-cli</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">-p</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">8989</span><span style="color:#ABB2BF;"> </span><span style="color:#7F848E;font-style:italic;">#客户端连接服务器的8989端口</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="`+v+`" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h2 id="配置文件" tabindex="-1"><a class="header-anchor" href="#配置文件" aria-hidden="true">#</a> 配置文件</h2><p><code>redis-server --port 8989</code>这种启动方式<code>ctrl + c</code>服务器程序就会结束，该端口也就不被redis服务器监听。实际工作中都是使用配置文件的方式来启动redis-server</p><p>由于redis.conf文件信息过多，我们去掉注释，并且去掉空白，导出主要信息并生成新的配置文件<code>redis-6379.conf</code></p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="shiki one-dark-pro" style="background-color:#282c34;" tabindex="0"><code><span class="line"><span style="color:#56B6C2;">cd</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">/etc/redis/</span></span>
<span class="line"><span style="color:#61AFEF;">cat</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">6379</span><span style="color:#98C379;">.conf</span><span style="color:#ABB2BF;"> |</span><span style="color:#61AFEF;">grep</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">-v</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&quot;#&quot;</span><span style="color:#ABB2BF;">|</span><span style="color:#61AFEF;">grep</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">-v</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&quot;^$&quot;</span><span style="color:#ABB2BF;"> &gt; </span><span style="color:#98C379;">redis-6379.conf</span><span style="color:#ABB2BF;"> </span><span style="color:#7F848E;font-style:italic;">#root账户执行</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="`+u+'" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure>',13),b=s("strong",null,"配置大小单位",-1),F=s("strong",null,"只支持bytes，不支持bit",-1),h=s("strong",null,"对大小写不敏感",-1),g=a(`<h3 id="基本配置" tabindex="-1"><a class="header-anchor" href="#基本配置" aria-hidden="true">#</a> 基本配置</h3><p>基本配置(指定端口、后台启动、日志文件名和路径)，其他暂时不管，保存配置文件</p><div class="language-ini line-numbers-mode" data-ext="ini"><pre class="shiki one-dark-pro" style="background-color:#282c34;" tabindex="0"><code><span class="line"><span style="color:#7F848E;font-style:italic;">#redis-6380.conf</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># 绑定的port</span></span>
<span class="line"><span style="color:#98C379;">port 6380	</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">#守护进程方法启动，yes则后台启动，没有打印信息；no则前台启动</span></span>
<span class="line"><span style="color:#98C379;">daemonize yes </span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># 后台启动时，日志文件名</span></span>
<span class="line"><span style="color:#98C379;">logfile /var/log/redis_6380.log	 </span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># 后台显示时，日志文件路径</span></span>
<span class="line"><span style="color:#98C379;">dir /var/lib/redis/6380		</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="shiki one-dark-pro" style="background-color:#282c34;" tabindex="0"><code><span class="line"><span style="color:#61AFEF;">redis-server</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">redis-6380.conf</span><span style="color:#ABB2BF;"> </span><span style="color:#7F848E;font-style:italic;">#以配置文件启动redis,启动后就是守护进程</span></span>
<span class="line"><span style="color:#61AFEF;">redis-cli</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">-p</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">6380</span></span>
<span class="line"><span style="color:#61AFEF;">redis-cli</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">-h</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">127.0</span><span style="color:#98C379;">.0.1</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">-p</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">6380</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="其他相关配置" tabindex="-1"><a class="header-anchor" href="#其他相关配置" aria-hidden="true">#</a> 其他相关配置</h3><div class="language-ini line-numbers-mode" data-ext="ini"><pre class="shiki one-dark-pro" style="background-color:#282c34;" tabindex="0"><code><span class="line"><span style="color:#7F848E;font-style:italic;">#服务器配置</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">#绑定主机地址</span></span>
<span class="line"><span style="color:#98C379;">bind 127.0.0.1 </span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># 保护模式</span></span>
<span class="line"><span style="color:#98C379;">protected-mode yes </span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">#设置数据库数量</span></span>
<span class="line"><span style="color:#98C379;">databases 16 </span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">#设置服务器以指定日志记录级别</span></span>
<span class="line"><span style="color:#98C379;">loglevel debug|verbose|notice|warning </span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>注意：<strong>日志级别开发期设置为verbose即可，生产环境中配置为notice，简化日志输出量，降低写日志IO的频度。开发阶段一般使用debug，会打印较多的信息</strong></p><blockquote><p>Protected-mode 是为了禁止公网访问redis cache，加强redis安全的。</p><p>它启用的条件，有两个： 1） 没有bind IP 2） 没有设置访问密码</p><p>如果启用了，则只能够通过lookback ip（127.0.0.1）访问Redis cache，如果从外网访问，则会返回相应的错误信息</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="shiki one-dark-pro" style="background-color:#282c34;" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;">(</span><span style="color:#61AFEF;">error</span><span style="color:#ABB2BF;">) DENIED Redis is running </span><span style="color:#C678DD;">in</span><span style="color:#ABB2BF;"> protected mode because protected mode is enabled, no bind address was specified, no authentication password is requested to clients. In this mode connections are only accepted from the lookback interface. If you want to connect from external computers to Redis you may adopt one of the following solutions: 1) Just disable protected mode sending the command </span><span style="color:#98C379;">&#39;CONFIG SET protected-mode no&#39;</span><span style="color:#ABB2BF;"> from the loopback interface by connecting to Redis from the same host the server is running, however MAKE SURE Redis is not publicly accessible from internet </span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">you</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">do</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">so.</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">Use</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">CONFIG</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">REWRITE</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">to</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">make</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">this</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">change</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">permanent.</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">2</span><span style="color:#ABB2BF;">) Alternatively you can just disable the protected mode by editing the Redis configuration file, and setting the protected mode option to </span><span style="color:#98C379;">&#39;no&#39;</span><span style="color:#ABB2BF;">, and </span><span style="color:#C678DD;">then</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">restarting</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">the</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">server.</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">3</span><span style="color:#ABB2BF;">) If you started the server manually just </span><span style="color:#C678DD;">for</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;">testing, restart it with the --portected-mode no option. 4) Setup a bind address or an authentication password. NOTE: You only need to do one of the above things</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">in</span><span style="color:#ABB2BF;"> order </span><span style="color:#C678DD;">for</span><span style="color:#ABB2BF;"> the server to start accepting connections from the outside.</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></blockquote><div class="language-ini line-numbers-mode" data-ext="ini"><pre class="shiki one-dark-pro" style="background-color:#282c34;" tabindex="0"><code><span class="line"><span style="color:#7F848E;font-style:italic;">#客户端配置</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">#设置同一时间最大客户链接数，默认无限制。当客户端连接到达上线，Redis会关闭新的链接</span></span>
<span class="line"><span style="color:#98C379;">maxclients 0  </span><span style="color:#7F848E;font-style:italic;"># 0表示没有限制</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">#客户端不活动占用连接最大时长，达到最大时长后关闭连接。如需关闭该功能，设置为0</span></span>
<span class="line"><span style="color:#98C379;">timeout 300  </span><span style="color:#7F848E;font-style:italic;"># 300s</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-ini line-numbers-mode" data-ext="ini"><pre class="shiki one-dark-pro" style="background-color:#282c34;" tabindex="0"><code><span class="line"><span style="color:#7F848E;font-style:italic;">#多服务器快捷配置</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">#导入并加载指定配置文件信息，用于快速创建redis公共配置较多的redis实例配置文件，便于维护。这里有点像继承了，先include一个基础配置文件，然后再添加其他的配置</span></span>
<span class="line"><span style="color:#98C379;">include /path/base_server.conf</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-ini line-numbers-mode" data-ext="ini"><pre class="shiki one-dark-pro" style="background-color:#282c34;" tabindex="0"><code><span class="line"><span style="color:#7F848E;font-style:italic;">#快照相关配置</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">#保存快照</span></span>
<span class="line"><span style="color:#98C379;">save 900 1              </span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">#在900秒(15分钟)之后，如果至少有1个key发生变化，则dump内存快照。</span></span>
<span class="line"><span style="color:#98C379;">save 300 10            </span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">#在300秒(5分钟)之后，如果至少有10个key发生变化，则dump内存快照。</span></span>
<span class="line"><span style="color:#98C379;">save 60 10000       </span></span>
<span class="line"><span style="color:#98C379;"> </span><span style="color:#7F848E;font-style:italic;">#在60秒(1分钟)之后，如果至少有10000个key发生变化，则dump内存快照。</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">#快照文件名</span></span>
<span class="line"><span style="color:#98C379;">dbfilename dump.rdb</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">#保存目录名</span></span>
<span class="line"><span style="color:#98C379;">dir /var/lib/redis/6379</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-ini line-numbers-mode" data-ext="ini"><pre class="shiki one-dark-pro" style="background-color:#282c34;" tabindex="0"><code><span class="line"><span style="color:#7F848E;font-style:italic;">#AOF持久化方式配置</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># 是否使用AOF持久化方式。默认不使用</span></span>
<span class="line"><span style="color:#98C379;">appendonly yes  </span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">#持久化的AOF文件名</span></span>
<span class="line"><span style="color:#98C379;">appendfilename </span><span style="color:#98C379;">&quot;appendonly6381.aof&quot;</span><span style="color:#98C379;">  </span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">#在Redis的配置文件中存在三种AOF同步方式，它们分别是：</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">#每次有数据修改发生时都会写入AOF文件。</span></span>
<span class="line"><span style="color:#98C379;">appendfsync always    </span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">#每秒钟同步一次，该策略为AOF的缺省策略。</span></span>
<span class="line"><span style="color:#98C379;">appendfsync everysec  </span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">#从不同步。高效但是数据不会被持久化。</span></span>
<span class="line"><span style="color:#98C379;">appendfsync no          </span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,12);function f(A,C){const e=i("font");return o(),p("div",null,[m,s("ul",null,[s("li",null,[n("带注释的配置文件中给出了"),b,n("，定义了一些基本度量单位，"),c(e,{color:"red"},{default:r(()=>[F,n("，"),h]),_:1})])]),g])}const x=l(B,[["render",f],["__file","Redis的安装.html.vue"]]);export{x as default};

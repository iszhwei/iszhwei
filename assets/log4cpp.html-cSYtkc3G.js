import{_ as t}from"./plugin-vue_export-helper-x3n3nnut.js";import{r as c,o as r,c as B,d as n,e as s,f as a,w as p,a as o}from"./app-rY1SOIco.js";const i="/assets/image-20240411204317307-LS3W52N-.png",y="/assets/image-20240411204413778-nE0-s1NN.png",d="/assets/image-20240411203054816-4VBVPOb2.png",F={},A=n("h1",{id:"log4cpp的使用",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#log4cpp的使用","aria-hidden":"true"},"#"),s(" log4cpp的使用")],-1),u={href:"https://log4cpp.sourceforge.net/api/index.html",target:"_blank",rel:"noopener noreferrer"},v=n("h2",{id:"安装",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#安装","aria-hidden":"true"},"#"),s(" 安装")],-1),C={href:"https://sourceforge.net/projects/log4cpp/",target:"_blank",rel:"noopener noreferrer"},D=o(`<ol><li><p>下载log4cpp（如log4cpp-1.1.1.tar.gz）</p></li><li><p>先将log4cpp-1.1.1.tar.gz拖入用户主目录(~)</p></li><li><p>依次执行下面的步骤</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="shiki one-dark-pro" style="background-color:#282c34;" tabindex="0"><code><span class="line"><span style="color:#61AFEF;">$</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">cd</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">~/log4cpp/</span></span>
<span class="line"><span style="color:#61AFEF;">$</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">./configure</span></span>
<span class="line"><span style="color:#61AFEF;">$</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">make</span></span>
<span class="line"><span style="color:#61AFEF;">$</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">make</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">check</span></span>
<span class="line"><span style="color:#61AFEF;">$</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">sudo</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">make</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">install</span></span>
<span class="line"><span style="color:#61AFEF;">//这里已经安装成功.</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ol><p><strong>默认lib库路径</strong>是 ： <code>/usr/local/lib/</code></p><figure><img src="`+i+'" alt="image-20240411204317307" tabindex="0" loading="lazy"><figcaption>image-20240411204317307</figcaption></figure><p><strong>默认头文件的位置</strong>： <code>/usr/local/include/log4cpp</code></p><figure><img src="'+y+'" alt="image-20240411204413778" tabindex="0" loading="lazy"><figcaption>image-20240411204413778</figcaption></figure><h3 id="make出现报错-iso-c-17-does-not-allow-dynamic-exception-specifications" tabindex="-1"><a class="header-anchor" href="#make出现报错-iso-c-17-does-not-allow-dynamic-exception-specifications" aria-hidden="true">#</a> make出现报错 ISO C++17 does not allow dynamic exception specifications</h3><figure><img src="'+d+`" alt="image-20240411203054816" tabindex="0" loading="lazy"><figcaption>image-20240411203054816</figcaption></figure><p><strong>解决方法</strong>：</p><ol><li>安装低版本的g++及gcc（如g++-9及gcc-9）</li></ol><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="shiki one-dark-pro" style="background-color:#282c34;" tabindex="0"><code><span class="line"><span style="color:#61AFEF;">sudo</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">apt-get</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">install</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">gcc-9</span></span>
<span class="line"><span style="color:#61AFEF;">sudo</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">apt-get</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">install</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">g++-9</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><ol start="2"><li>设置默认编辑器</li></ol><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="shiki one-dark-pro" style="background-color:#282c34;" tabindex="0"><code><span class="line"><span style="color:#61AFEF;">sudo</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">update-alternatives</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">--install</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">/usr/bin/gcc</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">gcc</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">/usr/bin/gcc-9</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">50</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">--slave</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">/usr/bin/g++</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">g++</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">/usr/bin/g++-9</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="log4cpp基本结构" tabindex="-1"><a class="header-anchor" href="#log4cpp基本结构" aria-hidden="true">#</a> log4cpp基本结构</h2>`,13),m=n("strong",null,"日志类别(Category)",-1),g=n("h3",{id:"日志类别-category",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#日志类别-category","aria-hidden":"true"},"#"),s(" 日志类别(Category)")],-1),b=n("strong",null,"日志级别",-1),E=n("strong",null,"低于此优先级的类都不再输出",-1),h=n("strong",null,"可以有多个分类，但每个应用程序都有一个root分类",-1),f=o(`<div class="language-c++ line-numbers-mode" data-ext="c++"><pre class="shiki one-dark-pro" style="background-color:#282c34;" tabindex="0"><code><span class="line"><span style="color:#7F848E;font-style:italic;">// 根分类root</span></span>
<span class="line"><span style="color:#ABB2BF;">log4cpp::Category</span><span style="color:#56B6C2;">&amp;</span><span style="color:#ABB2BF;"> root </span><span style="color:#C678DD;">=</span><span style="color:#ABB2BF;"> log4cpp::</span><span style="color:#E5C07B;">Category</span><span style="color:#ABB2BF;">::</span><span style="color:#61AFEF;">getRoot</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// 子分类subCat1</span></span>
<span class="line"><span style="color:#ABB2BF;">log4cpp::Category</span><span style="color:#56B6C2;">&amp;</span><span style="color:#ABB2BF;"> sub1 </span><span style="color:#C678DD;">=</span><span style="color:#ABB2BF;"> log4cpp::</span><span style="color:#E5C07B;">Category</span><span style="color:#ABB2BF;">::</span><span style="color:#61AFEF;">getInstance</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;sub1&quot;</span><span style="color:#ABB2BF;">);</span><span style="color:#7F848E;font-style:italic;">	//用于%c时输出Category的类别“sub1”</span></span>
<span class="line"><span style="color:#ABB2BF;"> </span></span>
<span class="line"><span style="color:#E5C07B;">root</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">error</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;test root error&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#E5C07B;">root</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">warn</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;test root error&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#E5C07B;">root</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">info</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;test root error&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;"> </span></span>
<span class="line"><span style="color:#E5C07B;">sub1</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">fatal</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;test sub1 error&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#E5C07B;">sub1</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">notice</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;test sub1 error&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#E5C07B;">sub1</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">debug</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;test sub1 error&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="日志追加器-appender" tabindex="-1"><a class="header-anchor" href="#日志追加器-appender" aria-hidden="true">#</a> 日志追加器(Appender)</h3>`,2),_=n("strong",null,"输出到哪儿，如何输出",-1),q=n("strong",null,"一个Category可以加载多个Appender，输出到多个地方",-1),L=o(`<div class="language-c++ line-numbers-mode" data-ext="c++"><pre class="shiki one-dark-pro" style="background-color:#282c34;" tabindex="0"><code><span class="line"><span style="color:#7F848E;font-style:italic;">// log4cpp::OstreamAppender:输出到输出流中（输出到控制台上）</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// log4cpp::FileAppender：输出到文件中</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// log4cpp::RollingFileAppender：输出到文件中并且能够设置文件最大超过多少时生成新文件</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// log4cpp::DailyRollingFileAppender：每天生成一个新文件</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// log4cpp::NTEventLogAppender：将日志输出到Windows事件日志中去</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// log4cpp::StringQueueAppender               // 内存队列</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// ...</span></span>
<span class="line"><span style="color:#ABB2BF;">log4cpp::Appender </span><span style="color:#56B6C2;">*</span><span style="color:#ABB2BF;">appender </span><span style="color:#C678DD;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">new</span><span style="color:#ABB2BF;"> log4cpp::</span><span style="color:#61AFEF;">FileAppender</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;test&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;D:/log4cppTest/log4cppTest.log&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#E5C07B;">root</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">addAppender</span><span style="color:#ABB2BF;">(appender);</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="stringqueueappender-内存队列-多线程调试" tabindex="-1"><a class="header-anchor" href="#stringqueueappender-内存队列-多线程调试" aria-hidden="true">#</a> StringQueueAppender 内存队列-多线程调试</h3>`,2),x=n("u",null,"因为printf导致IO中断，会使得本线程挂起，其花费的时间比一条普通指令多数千倍，若多个线程同时运行，则严重干扰了线程间的运行方式",-1),k=n("strong",null,"调试多线程程序时，最好是将所有调试信息按顺序记入内存中，程序结束时依次打印出来",-1),P=n("code",null,"std::string",-1),w=n("code",null,"std::queue",-1),T=o(`<p><strong><code>std::queue&lt;std::string&gt; _queue;</code></strong> _queue变量是StringQueueAppender类中用于具体存储日志的内存队列。StringQueueAppender的使用方法与OstreamAppender类似，其创建函数<strong>只接收一个参数“名称”，记录完成后需要程序员自己从队列中取出每条日志</strong>，例子程序StringQueueAppenderExam如下：</p><div class="language-c++ line-numbers-mode" data-ext="c++"><pre class="shiki one-dark-pro" style="background-color:#282c34;" tabindex="0"><code><span class="line"><span style="color:#C678DD;">#include</span><span style="color:#98C379;">&lt;iostream&gt;</span></span>
<span class="line"><span style="color:#C678DD;">#include</span><span style="color:#98C379;">&lt;log4cpp/Category.hh&gt;</span></span>
<span class="line"><span style="color:#C678DD;">#include</span><span style="color:#98C379;">&lt;log4cpp/OstreamAppender.hh&gt;</span></span>
<span class="line"><span style="color:#C678DD;">#include</span><span style="color:#98C379;">&lt;log4cpp/BasicLayout.hh&gt;</span></span>
<span class="line"><span style="color:#C678DD;">#include</span><span style="color:#98C379;">&lt;log4cpp/Priority.hh&gt;</span></span>
<span class="line"><span style="color:#C678DD;">#include</span><span style="color:#98C379;">&lt;log4cpp/StringQueueAppender.hh&gt;</span></span>
<span class="line"><span style="color:#C678DD;">using</span><span style="color:#ABB2BF;"> namespacestd;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">int</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">main</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">int</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;font-style:italic;">argc</span><span style="color:#ABB2BF;">,</span><span style="color:#C678DD;">char*</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;font-style:italic;">argv</span><span style="color:#ABB2BF;">[])</span></span>
<span class="line"><span style="color:#ABB2BF;">{</span></span>
<span class="line"><span style="color:#ABB2BF;">    log4cpp::StringQueueAppender</span><span style="color:#56B6C2;">*</span><span style="color:#ABB2BF;"> strQAppender </span><span style="color:#C678DD;">=</span><span style="color:#ABB2BF;"> newlog4cpp::</span><span style="color:#61AFEF;">StringQueueAppender</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;strQAppender&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E5C07B;">strQAppender</span><span style="color:#ABB2BF;">-&gt;</span><span style="color:#61AFEF;">setLayout</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">newlog4cpp</span><span style="color:#ABB2BF;">::</span><span style="color:#61AFEF;">BasicLayout</span><span style="color:#ABB2BF;">());</span></span>
<span class="line"><span style="color:#ABB2BF;">    log4cpp::Category</span><span style="color:#56B6C2;">&amp;</span><span style="color:#ABB2BF;"> root </span><span style="color:#C678DD;">=</span><span style="color:#E5C07B;">log4cpp</span><span style="color:#ABB2BF;">::</span><span style="color:#E5C07B;">Category</span><span style="color:#ABB2BF;">::</span><span style="color:#61AFEF;">getRoot</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E5C07B;">root</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">addAppender</span><span style="color:#ABB2BF;">(strQAppender);</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E5C07B;">root</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">setPriority</span><span style="color:#ABB2BF;">(log4cpp::Priority::DEBUG);</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E5C07B;">root</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">error</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;Hello log4cpp in a Error Message!&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E5C07B;">root</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">warn</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;Hello log4cpp in a WarningMessage!&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">    cout</span><span style="color:#C678DD;">&lt;&lt;</span><span style="color:#98C379;">&quot;Get message from MemoryQueue!&quot;</span><span style="color:#C678DD;">&lt;&lt;</span><span style="color:#ABB2BF;">endl;</span></span>
<span class="line"><span style="color:#ABB2BF;">    cout</span><span style="color:#C678DD;">&lt;&lt;</span><span style="color:#98C379;">&quot;-------------------------------------------&quot;</span><span style="color:#C678DD;">&lt;&lt;</span><span style="color:#ABB2BF;">endl;</span></span>
<span class="line"><span style="color:#ABB2BF;">    queue</span><span style="color:#C678DD;">&lt;</span><span style="color:#ABB2BF;">string</span><span style="color:#C678DD;">&gt;</span><span style="color:#56B6C2;">&amp;</span><span style="color:#ABB2BF;"> myStrQ </span><span style="color:#C678DD;">=</span><span style="color:#E5C07B;">strQAppender</span><span style="color:#ABB2BF;">-&gt;</span><span style="color:#61AFEF;">getQueue</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#C678DD;">while</span><span style="color:#ABB2BF;">(</span><span style="color:#56B6C2;">!</span><span style="color:#E5C07B;">myStrQ</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">empty</span><span style="color:#ABB2BF;">())</span></span>
<span class="line"><span style="color:#ABB2BF;">    {</span></span>
<span class="line"><span style="color:#ABB2BF;">        cout</span><span style="color:#C678DD;">&lt;&lt;</span><span style="color:#E5C07B;">myStrQ</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">front</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#E5C07B;">myStrQ</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">pop</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#ABB2BF;">    }</span></span>
<span class="line"><span style="color:#ABB2BF;">    log4cpp::</span><span style="color:#E5C07B;">Category</span><span style="color:#ABB2BF;">::</span><span style="color:#61AFEF;">shutdown</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#C678DD;">return</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="日志布局-layout" tabindex="-1"><a class="header-anchor" href="#日志布局-layout" aria-hidden="true">#</a> 日志布局（Layout)</h3><p>Layout,设置日志输出风格，有BasicLayout、SimpleLayout、PatternLayout,其中BasicLayout，SimpleLayout主要是提供的成型的简单日志风格，实际中基本不会使用，主要是使用PatternLayout对日志做格式输出，Layout是加载到Appender中去的。</p><div class="language-c++ line-numbers-mode" data-ext="c++"><pre class="shiki one-dark-pro" style="background-color:#282c34;" tabindex="0"><code><span class="line"><span style="color:#7F848E;font-style:italic;">// %% 输出一个%</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> // %c 输出Categroy名称</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> // %d 输出日期</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> // %m 输出消息</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> // %n 输出换行</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> // %p 输出Priority</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> // %d{%Y-%m-%d %H:%M:%S:%l}对输出日期做定制，年月日时分秒毫秒</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> // %t 线程ID</span></span>
<span class="line"><span style="color:#ABB2BF;"> </span></span>
<span class="line"><span style="color:#ABB2BF;"> log4cpp::PatternLayout </span><span style="color:#56B6C2;">*</span><span style="color:#ABB2BF;">patternLayout </span><span style="color:#C678DD;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">new</span><span style="color:#ABB2BF;"> log4cpp::</span><span style="color:#61AFEF;">PatternLayout</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">patternLayout</span><span style="color:#ABB2BF;">-&gt;</span><span style="color:#61AFEF;">setConversionPattern</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;</span><span style="color:#D19A66;">%d</span><span style="color:#98C379;">{%Y-%m-</span><span style="color:#D19A66;">%d</span><span style="color:#98C379;"> %H:%M:</span><span style="color:#D19A66;">%S</span><span style="color:#98C379;">.%l} %t [</span><span style="color:#D19A66;">%p</span><span style="color:#98C379;">] %m </span><span style="color:#D19A66;">%n</span><span style="color:#98C379;">&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">appender</span><span style="color:#ABB2BF;">-&gt;</span><span style="color:#61AFEF;">setLayout</span><span style="color:#ABB2BF;">(patternLayout);</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="category、appender和layout三者的关系" tabindex="-1"><a class="header-anchor" href="#category、appender和layout三者的关系" aria-hidden="true">#</a> Category、Appender和Layout三者的关系</h3><p>系统中可以有多个Category，它们都是继承自同一个根，每个Category负责记录自己的日志;每个Category可以添加多个Appender，每个Appender指定了一个日志的目的地，例如文件、字符流或者Windows日志，当Category记录一条日志时，该日志被写入所有附加到此Category的Appender;每个Append都包含一个Layout，该Layout定义了这个Appender上日志的格式。</p><h3 id="日志级别-priority" tabindex="-1"><a class="header-anchor" href="#日志级别-priority" aria-hidden="true">#</a> 日志级别(Priority)</h3>`,8),R={id:"log4cpp记录日志的原理",tabindex:"-1"},O=n("a",{class:"header-anchor",href:"#log4cpp记录日志的原理","aria-hidden":"true"},"#",-1),N=o(`<h4 id="系统中默认的优先级等级如下" tabindex="-1"><a class="header-anchor" href="#系统中默认的优先级等级如下" aria-hidden="true">#</a> 系统中默认的优先级等级如下：</h4><div class="language-c++ line-numbers-mode" data-ext="c++"><pre class="shiki one-dark-pro" style="background-color:#282c34;" tabindex="0"><code><span class="line"><span style="color:#C678DD;">typedef</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">enum</span></span>
<span class="line"><span style="color:#ABB2BF;">{</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E06C75;">EMERG</span><span style="color:#ABB2BF;">  </span><span style="color:#C678DD;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">,</span><span style="color:#7F848E;font-style:italic;">     // emergency</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E06C75;">FATAL</span><span style="color:#ABB2BF;">  </span><span style="color:#C678DD;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">,</span><span style="color:#7F848E;font-style:italic;">     // fatal</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E06C75;">ALERT</span><span style="color:#ABB2BF;">  </span><span style="color:#C678DD;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">100</span><span style="color:#ABB2BF;">,</span><span style="color:#7F848E;font-style:italic;">   // alert</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E06C75;">CRIT</span><span style="color:#ABB2BF;">   </span><span style="color:#C678DD;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">200</span><span style="color:#ABB2BF;">,</span><span style="color:#7F848E;font-style:italic;">   // critical</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E06C75;">ERROR</span><span style="color:#ABB2BF;">  </span><span style="color:#C678DD;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">300</span><span style="color:#ABB2BF;">,</span><span style="color:#7F848E;font-style:italic;">   // error</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E06C75;">WARN</span><span style="color:#ABB2BF;">   </span><span style="color:#C678DD;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">400</span><span style="color:#ABB2BF;">,</span><span style="color:#7F848E;font-style:italic;">   // wanning</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E06C75;">NOTICE</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">500</span><span style="color:#ABB2BF;">,</span><span style="color:#7F848E;font-style:italic;">   // notice</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E06C75;">INFO</span><span style="color:#ABB2BF;">   </span><span style="color:#C678DD;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">600</span><span style="color:#ABB2BF;">,</span><span style="color:#7F848E;font-style:italic;">   // infomation</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E06C75;">DEBUG</span><span style="color:#ABB2BF;">  </span><span style="color:#C678DD;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">700</span><span style="color:#ABB2BF;">,</span><span style="color:#7F848E;font-style:italic;">   // debug</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E06C75;">NOTSET</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">800</span><span style="color:#ABB2BF;">   </span></span>
<span class="line"><span style="color:#ABB2BF;">} PriorityLevel;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>注意：<strong>取值越小，优先级越高</strong>。例如一个Category的优先级为101，则所有EMERG、FATAL、ALERT日志都可以记录下来，而其他则不能。</p><div class="language-c++ line-numbers-mode" data-ext="c++"><pre class="shiki one-dark-pro" style="background-color:#282c34;" tabindex="0"><code><span class="line"><span style="color:#7F848E;font-style:italic;">// 代码设置</span></span>
<span class="line"><span style="color:#E5C07B;">root</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">setPriority</span><span style="color:#ABB2BF;">(log4cpp::Priority::DEBUG);</span></span>
<span class="line"><span style="color:#E5C07B;">appender</span><span style="color:#ABB2BF;">-&gt;</span><span style="color:#61AFEF;">setThreshold</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="帮助类" tabindex="-1"><a class="header-anchor" href="#帮助类" aria-hidden="true">#</a> 帮助类</h3><p>帮助类， log4cpp主要提供如下几个类来简化代码设置：SimpleConfigurator，BasicConfigurator，PropertyConfigurator，其中SimpleConfigurator和BasicConfigurator，主要是使用代码的方式，进行了一些简单的默认配置，而PropertyConfigurator，是通过配置文件的方式对日志进行配置，也是最常用的,下面就是配置文件的格式：</p><div class="language-c++ line-numbers-mode" data-ext="c++"><pre class="shiki one-dark-pro" style="background-color:#282c34;" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;">#文件名为</span><span style="color:#E5C07B;">logTest</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">Property</span></span>
<span class="line"><span style="color:#ABB2BF;"> </span></span>
<span class="line"><span style="color:#ABB2BF;">#配置root Category的Priority为DEBUG, Appender为rootAppender</span></span>
<span class="line"><span style="color:#E5C07B;">log4cpp</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">rootCategory</span><span style="color:#C678DD;">=</span><span style="color:#ABB2BF;">DEBUG, rootAppender</span></span>
<span class="line"><span style="color:#ABB2BF;">#配置子Category sub1的Priority为DEBUG, Appender为A1</span></span>
<span class="line"><span style="color:#E5C07B;">log4cpp</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">category</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">sub1</span><span style="color:#C678DD;">=</span><span style="color:#ABB2BF;">DEBUG, A1</span></span>
<span class="line"><span style="color:#ABB2BF;"> </span></span>
<span class="line"><span style="color:#ABB2BF;">#配置rootAppender为FileAppender</span></span>
<span class="line"><span style="color:#E5C07B;">log4cpp</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">appender</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">rootAppender</span><span style="color:#C678DD;">=</span><span style="color:#ABB2BF;">FileAppender</span></span>
<span class="line"><span style="color:#ABB2BF;">#配置日志文件名为</span><span style="color:#E5C07B;">test1</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">log</span><span style="color:#ABB2BF;">，存放在D盘根目录下</span></span>
<span class="line"><span style="color:#E5C07B;">log4cpp</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">appender</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">rootAppender</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">fileName</span><span style="color:#C678DD;">=</span><span style="color:#ABB2BF;">D:</span><span style="color:#56B6C2;">/</span><span style="color:#E5C07B;">test1</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">log</span></span>
<span class="line"><span style="color:#ABB2BF;">#配置layout为PatternLayout</span></span>
<span class="line"><span style="color:#E5C07B;">log4cpp</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">appender</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">rootAppender</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">layout</span><span style="color:#C678DD;">=</span><span style="color:#ABB2BF;">PatternLayout</span></span>
<span class="line"><span style="color:#ABB2BF;">#设置日志输出风格</span></span>
<span class="line"><span style="color:#E5C07B;">log4cpp</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">appender</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">rootAppender</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">layout</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">ConversionPattern</span><span style="color:#C678DD;">=</span><span style="color:#56B6C2;">%</span><span style="color:#ABB2BF;">d{</span><span style="color:#56B6C2;">%</span><span style="color:#ABB2BF;">Y</span><span style="color:#56B6C2;">-%</span><span style="color:#ABB2BF;">m</span><span style="color:#56B6C2;">-%</span><span style="color:#ABB2BF;">d </span><span style="color:#56B6C2;">%</span><span style="color:#E06C75;">H</span><span style="color:#ABB2BF;">:</span><span style="color:#56B6C2;">%</span><span style="color:#E06C75;">M</span><span style="color:#ABB2BF;">:</span><span style="color:#56B6C2;">%</span><span style="color:#ABB2BF;">S.</span><span style="color:#56B6C2;">%</span><span style="color:#ABB2BF;">l} </span><span style="color:#56B6C2;">%</span><span style="color:#ABB2BF;">t [</span><span style="color:#56B6C2;">%</span><span style="color:#ABB2BF;">p] </span><span style="color:#56B6C2;">%</span><span style="color:#ABB2BF;">m </span><span style="color:#56B6C2;">%</span><span style="color:#ABB2BF;">n</span></span>
<span class="line"><span style="color:#ABB2BF;"> </span></span>
<span class="line"><span style="color:#ABB2BF;">#配置A1为RollingFileAppender</span></span>
<span class="line"><span style="color:#E5C07B;">log4cpp</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">appender</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">A1</span><span style="color:#C678DD;">=</span><span style="color:#ABB2BF;">RollingFileAppender</span></span>
<span class="line"><span style="color:#ABB2BF;">#配置日志文件名为</span><span style="color:#E5C07B;">test2</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">log</span><span style="color:#ABB2BF;">，存放在D盘根目录下</span></span>
<span class="line"><span style="color:#E5C07B;">log4cpp</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">appender</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">A1</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">fileName</span><span style="color:#C678DD;">=</span><span style="color:#ABB2BF;">D:</span><span style="color:#56B6C2;">/</span><span style="color:#E5C07B;">test2</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">log</span></span>
<span class="line"><span style="color:#ABB2BF;">#配置日志文件最大不能超过1M</span></span>
<span class="line"><span style="color:#E5C07B;">log4cpp</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">appender</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">A1</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">maxFileSize</span><span style="color:#C678DD;">=</span><span style="color:#D19A66;">1024</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">*</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">1024</span></span>
<span class="line"><span style="color:#ABB2BF;">#日志文件最多存储3个文件，超过就会删除旧的</span></span>
<span class="line"><span style="color:#E5C07B;">log4cpp</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">appender</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">A1</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">maxBackupIndex</span><span style="color:#C678DD;">=</span><span style="color:#D19A66;">2</span></span>
<span class="line"><span style="color:#ABB2BF;">#设置日志风格</span></span>
<span class="line"><span style="color:#E5C07B;">log4cpp</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">appender</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">A1</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">layout</span><span style="color:#C678DD;">=</span><span style="color:#ABB2BF;">PatternLayout</span></span>
<span class="line"><span style="color:#E5C07B;">log4cpp</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">appender</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">A1</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">layout</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">ConversionPattern</span><span style="color:#C678DD;">=</span><span style="color:#56B6C2;">%</span><span style="color:#ABB2BF;">d{</span><span style="color:#56B6C2;">%</span><span style="color:#ABB2BF;">Y</span><span style="color:#56B6C2;">-%</span><span style="color:#ABB2BF;">m</span><span style="color:#56B6C2;">-%</span><span style="color:#ABB2BF;">d </span><span style="color:#56B6C2;">%</span><span style="color:#E06C75;">H</span><span style="color:#ABB2BF;">:</span><span style="color:#56B6C2;">%</span><span style="color:#E06C75;">M</span><span style="color:#ABB2BF;">:</span><span style="color:#56B6C2;">%</span><span style="color:#ABB2BF;">S.</span><span style="color:#56B6C2;">%</span><span style="color:#ABB2BF;">l} </span><span style="color:#56B6C2;">%</span><span style="color:#ABB2BF;">t [</span><span style="color:#56B6C2;">%</span><span style="color:#ABB2BF;">p] </span><span style="color:#56B6C2;">%</span><span style="color:#ABB2BF;">m </span><span style="color:#56B6C2;">%</span><span style="color:#ABB2BF;">n</span></span>
<span class="line"><span style="color:#ABB2BF;"> </span></span>
<span class="line"><span style="color:#ABB2BF;"> </span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// 代码设置配置文件</span></span>
<span class="line"><span style="color:#E5C07B;">log4cpp</span><span style="color:#ABB2BF;">::</span><span style="color:#E5C07B;">PropertyConfigurator</span><span style="color:#ABB2BF;">::</span><span style="color:#61AFEF;">configure</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">logTest</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">Property</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="注意" tabindex="-1"><a class="header-anchor" href="#注意" aria-hidden="true">#</a> 注意</h2>`,8),S=o(`<h2 id="代码使用" tabindex="-1"><a class="header-anchor" href="#代码使用" aria-hidden="true">#</a> 代码使用</h2><h3 id="windows环境下" tabindex="-1"><a class="header-anchor" href="#windows环境下" aria-hidden="true">#</a> windows环境下</h3><p>获取到源代码后，找到源码目录中的msvc10目录，使用VS2010打开msvc10.sln解决方案文件，编译源码获得log4cpp.DLL和log4cpp.lib;在源码目录中有include文件夹，将include整个拷贝到我们的工程目录下，将include添加到工程属性中的附加包含目录中(QT工程则添加到INCLUDEPATH中去)，这时就能够正常使用了。</p><h3 id="linux环境下" tabindex="-1"><a class="header-anchor" href="#linux环境下" aria-hidden="true">#</a> linux环境下</h3><p>编译使用log4cpp库的CPP文件时，要加上库文件，才能顺利的编译通过，如下示例</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="shiki one-dark-pro" style="background-color:#282c34;" tabindex="0"><code><span class="line"><span style="color:#61AFEF;">$</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">g++</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">log4test.cpp</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">-llog4cpp</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">-lpthread</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div>`,6),I=n("strong",null,"找不到log4cpp的动态库",-1),Q=o(`<ol><li>以管理员身份登录终端，然后执行以下操作：</li></ol><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="shiki one-dark-pro" style="background-color:#282c34;" tabindex="0"><code><span class="line"><span style="color:#61AFEF;">$</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">sudo</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">vim</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">/etc/ld.so.conf</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ol start="2"><li>在打开的文件末尾另起一行添加动态库log4cpp的路径(这里是/usr/local/lib)，然后保存退出</li><li>执行命令ldconfig使设置生效即可。</li></ol><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="shiki one-dark-pro" style="background-color:#282c34;" tabindex="0"><code><span class="line"><span style="color:#61AFEF;">$</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">sudo</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">ldconfig</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">//更新库文件的缓存信息</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="测试用例" tabindex="-1"><a class="header-anchor" href="#测试用例" aria-hidden="true">#</a> 测试用例</h2><div class="language-c++ line-numbers-mode" data-ext="c++"><pre class="shiki one-dark-pro" style="background-color:#282c34;" tabindex="0"><code><span class="line"><span style="color:#C678DD;">#include</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&lt;log4cpp/BasicLayout.hh&gt;</span></span>
<span class="line"><span style="color:#C678DD;">#include</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&lt;log4cpp/SimpleLayout.hh&gt;</span></span>
<span class="line"><span style="color:#C678DD;">#include</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&lt;log4cpp/PatternLayout.hh&gt;</span></span>
<span class="line"><span style="color:#C678DD;">#include</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&lt;log4cpp/OstreamAppender.hh&gt;</span></span>
<span class="line"><span style="color:#C678DD;">#include</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&lt;log4cpp/FileAppender.hh&gt;</span></span>
<span class="line"><span style="color:#C678DD;">#include</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&lt;log4cpp/RollingFileAppender.hh&gt;</span></span>
<span class="line"><span style="color:#C678DD;">#include</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&lt;log4cpp/Category.hh&gt;</span></span>
<span class="line"><span style="color:#C678DD;">#include</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&lt;log4cpp/Priority.hh&gt;</span></span>
<span class="line"><span style="color:#C678DD;">#include</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&lt;iostream&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">using</span><span style="color:#ABB2BF;"> std::cout;</span></span>
<span class="line"><span style="color:#C678DD;">using</span><span style="color:#ABB2BF;"> std::endl;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">using</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">namespace</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">log4cpp</span><span style="color:#ABB2BF;">;</span><span style="color:#7F848E;font-style:italic;">//一次性将log4cpp中的实体全部引出来</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">void</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">test</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">{</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    //日志的格式</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    /* BasicLayout *pbl = new BasicLayout(); */</span></span>
<span class="line"><span style="color:#ABB2BF;">    SimpleLayout </span><span style="color:#56B6C2;">*</span><span style="color:#ABB2BF;">psl </span><span style="color:#C678DD;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">new</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">SimpleLayout</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    //日志的目的地</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    /* OstreamAppender *pos = new OstreamAppender(&quot;OstreamAppender123&quot;, &amp;cout); */</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    /* pos-&gt;setLayout(pbl); */</span></span>
<span class="line"><span style="color:#ABB2BF;">    OstreamAppender </span><span style="color:#56B6C2;">*</span><span style="color:#ABB2BF;">pos </span><span style="color:#C678DD;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">new</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">OstreamAppender</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;OstreamAppender123&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#56B6C2;">&amp;</span><span style="color:#ABB2BF;">cout);</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E5C07B;">pos</span><span style="color:#ABB2BF;">-&gt;</span><span style="color:#61AFEF;">setLayout</span><span style="color:#ABB2BF;">(psl);</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    //日志种类（日志记录器）</span></span>
<span class="line"><span style="color:#ABB2BF;">    Category </span><span style="color:#56B6C2;">&amp;</span><span style="color:#ABB2BF;">root </span><span style="color:#C678DD;">=</span><span style="color:#ABB2BF;"> Category::</span><span style="color:#61AFEF;">getRoot</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E5C07B;">root</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">addAppender</span><span style="color:#ABB2BF;">(pos);</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E5C07B;">root</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">setPriority</span><span style="color:#ABB2BF;">(Priority::ERROR);</span><span style="color:#7F848E;font-style:italic;">//过滤器</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E5C07B;">root</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">fatal</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;The log is fatal&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E5C07B;">root</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">alert</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;The log is alter&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E5C07B;">root</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">crit</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;The log is crit&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E5C07B;">root</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">error</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;The log is error&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E5C07B;">root</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">warn</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;The log is warn&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    //回收资源</span></span>
<span class="line"><span style="color:#ABB2BF;">    Category::</span><span style="color:#61AFEF;">shutdown</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">void</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">test2</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">{</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    //日志的格式</span></span>
<span class="line"><span style="color:#ABB2BF;">    PatternLayout </span><span style="color:#56B6C2;">*</span><span style="color:#ABB2BF;">ppl1 </span><span style="color:#C678DD;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">new</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">PatternLayout</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E5C07B;">ppl1</span><span style="color:#ABB2BF;">-&gt;</span><span style="color:#61AFEF;">setConversionPattern</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;</span><span style="color:#D19A66;">%d</span><span style="color:#98C379;"> </span><span style="color:#D19A66;">%c</span><span style="color:#98C379;"> [</span><span style="color:#D19A66;">%p</span><span style="color:#98C379;">] %m </span><span style="color:#D19A66;">%n</span><span style="color:#98C379;">&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">    PatternLayout </span><span style="color:#56B6C2;">*</span><span style="color:#ABB2BF;">ppl2 </span><span style="color:#C678DD;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">new</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">PatternLayout</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E5C07B;">ppl2</span><span style="color:#ABB2BF;">-&gt;</span><span style="color:#61AFEF;">setConversionPattern</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;</span><span style="color:#D19A66;">%d</span><span style="color:#98C379;"> </span><span style="color:#D19A66;">%c</span><span style="color:#98C379;"> [</span><span style="color:#D19A66;">%p</span><span style="color:#98C379;">] %m </span><span style="color:#D19A66;">%n</span><span style="color:#98C379;">&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    //日志的目的地</span></span>
<span class="line"><span style="color:#ABB2BF;">    OstreamAppender </span><span style="color:#56B6C2;">*</span><span style="color:#ABB2BF;">pos </span><span style="color:#C678DD;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">new</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">OstreamAppender</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;OstreamAppender123&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#56B6C2;">&amp;</span><span style="color:#ABB2BF;">cout);</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E5C07B;">pos</span><span style="color:#ABB2BF;">-&gt;</span><span style="color:#61AFEF;">setLayout</span><span style="color:#ABB2BF;">(ppl1);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">    RollingFileAppender </span><span style="color:#56B6C2;">*</span><span style="color:#ABB2BF;">ppfa </span><span style="color:#C678DD;">=</span><span style="color:#ABB2BF;"> </span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#C678DD;">new</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">RollingFileAppender</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;RollingFileAppender123&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;test.log&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">                                </span><span style="color:#D19A66;">5</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">*</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">1024</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">3</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E5C07B;">ppfa</span><span style="color:#ABB2BF;">-&gt;</span><span style="color:#61AFEF;">setLayout</span><span style="color:#ABB2BF;">(ppl2);</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    //日志种类（日志记录器）</span></span>
<span class="line"><span style="color:#ABB2BF;">    Category </span><span style="color:#56B6C2;">&amp;</span><span style="color:#ABB2BF;">root </span><span style="color:#C678DD;">=</span><span style="color:#ABB2BF;"> Category::</span><span style="color:#61AFEF;">getRoot</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E5C07B;">root</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">addAppender</span><span style="color:#ABB2BF;">(pos);</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E5C07B;">root</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">addAppender</span><span style="color:#ABB2BF;">(ppfa);</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E5C07B;">root</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">setPriority</span><span style="color:#ABB2BF;">(Priority::ERROR);</span><span style="color:#7F848E;font-style:italic;">//过滤器</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#C678DD;">size_t</span><span style="color:#ABB2BF;"> idx </span><span style="color:#C678DD;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#C678DD;">while</span><span style="color:#ABB2BF;">(idx </span><span style="color:#C678DD;">&lt;</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">100</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">    {</span></span>
<span class="line"><span style="color:#ABB2BF;">       </span><span style="color:#E5C07B;">root</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">fatal</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;The log is fatal&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">       </span><span style="color:#E5C07B;">root</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">alert</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;The log is alter&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">       </span><span style="color:#E5C07B;">root</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">crit</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;The log is crit&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">       </span><span style="color:#E5C07B;">root</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">error</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;The log is error&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">       </span><span style="color:#E5C07B;">root</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">warn</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;The log is warn&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">       </span><span style="color:#C678DD;">++</span><span style="color:#ABB2BF;">idx;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    //回收资源</span></span>
<span class="line"><span style="color:#ABB2BF;">    Category::</span><span style="color:#61AFEF;">shutdown</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"><span style="color:#C678DD;">void</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">test3</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">{</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    //日志的格式</span></span>
<span class="line"><span style="color:#ABB2BF;">    PatternLayout </span><span style="color:#56B6C2;">*</span><span style="color:#ABB2BF;">ppl1 </span><span style="color:#C678DD;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">new</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">PatternLayout</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E5C07B;">ppl1</span><span style="color:#ABB2BF;">-&gt;</span><span style="color:#61AFEF;">setConversionPattern</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;</span><span style="color:#D19A66;">%d</span><span style="color:#98C379;"> </span><span style="color:#D19A66;">%c</span><span style="color:#98C379;"> [</span><span style="color:#D19A66;">%p</span><span style="color:#98C379;">] %m </span><span style="color:#D19A66;">%n</span><span style="color:#98C379;">&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">    PatternLayout </span><span style="color:#56B6C2;">*</span><span style="color:#ABB2BF;">ppl2 </span><span style="color:#C678DD;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">new</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">PatternLayout</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E5C07B;">ppl2</span><span style="color:#ABB2BF;">-&gt;</span><span style="color:#61AFEF;">setConversionPattern</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;</span><span style="color:#D19A66;">%d</span><span style="color:#98C379;"> </span><span style="color:#D19A66;">%c</span><span style="color:#98C379;"> [</span><span style="color:#D19A66;">%p</span><span style="color:#98C379;">] %m </span><span style="color:#D19A66;">%n</span><span style="color:#98C379;">&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    //日志的目的地</span></span>
<span class="line"><span style="color:#ABB2BF;">    OstreamAppender </span><span style="color:#56B6C2;">*</span><span style="color:#ABB2BF;">pos </span><span style="color:#C678DD;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">new</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">OstreamAppender</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;OstreamAppender123&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#56B6C2;">&amp;</span><span style="color:#ABB2BF;">cout);</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E5C07B;">pos</span><span style="color:#ABB2BF;">-&gt;</span><span style="color:#61AFEF;">setLayout</span><span style="color:#ABB2BF;">(ppl1);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">    FileAppender </span><span style="color:#56B6C2;">*</span><span style="color:#ABB2BF;">pfl </span><span style="color:#C678DD;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">new</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">FileAppender</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;FileAppender1234&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;wd.log&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E5C07B;">pfl</span><span style="color:#ABB2BF;">-&gt;</span><span style="color:#61AFEF;">setLayout</span><span style="color:#ABB2BF;">(ppl2);</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    //日志种类（日志记录器）</span></span>
<span class="line"><span style="color:#ABB2BF;">    Category </span><span style="color:#56B6C2;">&amp;</span><span style="color:#ABB2BF;">root </span><span style="color:#C678DD;">=</span><span style="color:#ABB2BF;"> Category::</span><span style="color:#61AFEF;">getRoot</span><span style="color:#ABB2BF;">().</span><span style="color:#61AFEF;">getInstance</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;MyCat&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E5C07B;">root</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">addAppender</span><span style="color:#ABB2BF;">(pos);</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E5C07B;">root</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">addAppender</span><span style="color:#ABB2BF;">(pfl);</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E5C07B;">root</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">setPriority</span><span style="color:#ABB2BF;">(Priority::ERROR);</span><span style="color:#7F848E;font-style:italic;">//过滤器</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E5C07B;">root</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">fatal</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;The log is fatal&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E5C07B;">root</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">alert</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;The log is alter&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E5C07B;">root</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">crit</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;The log is crit&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E5C07B;">root</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">error</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;The log is error&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E5C07B;">root</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">warn</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;The log is warn&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    //回收资源</span></span>
<span class="line"><span style="color:#ABB2BF;">    Category::</span><span style="color:#61AFEF;">shutdown</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"><span style="color:#C678DD;">int</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">main</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">int</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;font-style:italic;">argc</span><span style="color:#ABB2BF;">, </span><span style="color:#C678DD;">char</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">**</span><span style="color:#E06C75;font-style:italic;">argv</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">{</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#61AFEF;">test2</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#C678DD;">return</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="封装成日志类-单例模式" tabindex="-1"><a class="header-anchor" href="#封装成日志类-单例模式" aria-hidden="true">#</a> 封装成日志类（单例模式）</h2><p>线程安全、自动释放、回滚日志、同时存在文件和屏幕打印</p><div class="language-c++ line-numbers-mode" data-ext="c++"><pre class="shiki one-dark-pro" style="background-color:#282c34;" tabindex="0"><code><span class="line"><span style="color:#C678DD;">#include</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&lt;log4cpp/Category.hh&gt;</span></span>
<span class="line"><span style="color:#C678DD;">#include</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&lt;log4cpp/RollingFileAppender.hh&gt;</span></span>
<span class="line"><span style="color:#C678DD;">#include</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&lt;log4cpp/OstreamAppender.hh&gt;</span></span>
<span class="line"><span style="color:#C678DD;">#include</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&lt;log4cpp/PatternLayout.hh&gt;</span></span>
<span class="line"><span style="color:#C678DD;">#include</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&lt;log4cpp/Priority.hh&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">#include</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&lt;iostream&gt;</span></span>
<span class="line"><span style="color:#C678DD;">#include</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&lt;string&gt;</span></span>
<span class="line"><span style="color:#C678DD;">using</span><span style="color:#ABB2BF;"> log4cpp::Category;</span></span>
<span class="line"><span style="color:#C678DD;">using</span><span style="color:#ABB2BF;"> log4cpp::RollingFileAppender;</span></span>
<span class="line"><span style="color:#C678DD;">using</span><span style="color:#ABB2BF;"> log4cpp::OstreamAppender;</span></span>
<span class="line"><span style="color:#C678DD;">using</span><span style="color:#ABB2BF;"> log4cpp::PatternLayout;</span></span>
<span class="line"><span style="color:#C678DD;">using</span><span style="color:#ABB2BF;"> log4cpp::Priority;</span></span>
<span class="line"><span style="color:#C678DD;">using</span><span style="color:#ABB2BF;"> std::cout;</span></span>
<span class="line"><span style="color:#C678DD;">using</span><span style="color:#ABB2BF;"> std::endl;</span></span>
<span class="line"><span style="color:#C678DD;">using</span><span style="color:#ABB2BF;"> std::string;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">class</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">Logger</span></span>
<span class="line"><span style="color:#ABB2BF;">{</span></span>
<span class="line"><span style="color:#C678DD;">public:</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#C678DD;">static</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">Logger</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">*</span><span style="color:#61AFEF;">getInstance</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">const</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">char*</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;font-style:italic;">fileName</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&quot;myLog.txt&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#C678DD;">static</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">void</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">destroy</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#C678DD;">void</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">warn</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">const</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">char</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">*</span><span style="color:#E06C75;font-style:italic;">msg</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#C678DD;">void</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">warn</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">const</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">char</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">*</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;font-style:italic;">msg</span><span style="color:#ABB2BF;">, </span><span style="color:#C678DD;">const</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">char</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">*</span><span style="color:#E06C75;font-style:italic;">file</span><span style="color:#ABB2BF;">, </span><span style="color:#C678DD;">const</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">char</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">*</span><span style="color:#E06C75;font-style:italic;">func</span><span style="color:#ABB2BF;">, </span><span style="color:#C678DD;">int</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;font-style:italic;">line</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#C678DD;">void</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">error</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">const</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">char</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">*</span><span style="color:#E06C75;font-style:italic;">msg</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#C678DD;">void</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">error</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">const</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">char</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">*</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;font-style:italic;">msg</span><span style="color:#ABB2BF;">, </span><span style="color:#C678DD;">const</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">char</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">*</span><span style="color:#E06C75;font-style:italic;">file</span><span style="color:#ABB2BF;">, </span><span style="color:#C678DD;">const</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">char</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">*</span><span style="color:#E06C75;font-style:italic;">func</span><span style="color:#ABB2BF;">, </span><span style="color:#C678DD;">int</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;font-style:italic;">line</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#C678DD;">void</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">debug</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">const</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">char</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">*</span><span style="color:#E06C75;font-style:italic;">msg</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#C678DD;">void</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">debug</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">const</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">char</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">*</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;font-style:italic;">msg</span><span style="color:#ABB2BF;">, </span><span style="color:#C678DD;">const</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">char</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">*</span><span style="color:#E06C75;font-style:italic;">file</span><span style="color:#ABB2BF;">, </span><span style="color:#C678DD;">const</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">char</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">*</span><span style="color:#E06C75;font-style:italic;">func</span><span style="color:#ABB2BF;">, </span><span style="color:#C678DD;">int</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;font-style:italic;">line</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#C678DD;">void</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">info</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">const</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">char</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">*</span><span style="color:#E06C75;font-style:italic;">msg</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#C678DD;">void</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">info</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">const</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">char</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">*</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;font-style:italic;">msg</span><span style="color:#ABB2BF;">, </span><span style="color:#C678DD;">const</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">char</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">*</span><span style="color:#E06C75;font-style:italic;">file</span><span style="color:#ABB2BF;">, </span><span style="color:#C678DD;">const</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">char</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">*</span><span style="color:#E06C75;font-style:italic;">func</span><span style="color:#ABB2BF;">, </span><span style="color:#C678DD;">int</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;font-style:italic;">line</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">private:</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#61AFEF;">Logger</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">string</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;font-style:italic;">fileName</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#61AFEF;">~Logger</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#61AFEF;">Logger</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">const</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">Logger</span><span style="color:#C678DD;">&amp;</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">delete</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E5C07B;">Logger</span><span style="color:#C678DD;">&amp;</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">operator</span><span style="color:#ABB2BF;">=(</span><span style="color:#C678DD;">const</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">Logger</span><span style="color:#C678DD;">&amp;</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">delete</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">private:</span></span>
<span class="line"><span style="color:#ABB2BF;">    PatternLayout </span><span style="color:#56B6C2;">*</span><span style="color:#ABB2BF;">_ptnLayout1;</span></span>
<span class="line"><span style="color:#ABB2BF;">    PatternLayout </span><span style="color:#56B6C2;">*</span><span style="color:#ABB2BF;">_ptnLayout2;</span></span>
<span class="line"><span style="color:#ABB2BF;">    OstreamAppender </span><span style="color:#56B6C2;">*</span><span style="color:#ABB2BF;">_osAppender;</span></span>
<span class="line"><span style="color:#ABB2BF;">    RollingFileAppender </span><span style="color:#56B6C2;">*</span><span style="color:#ABB2BF;">_rfAppender;</span></span>
<span class="line"><span style="color:#ABB2BF;">    Category </span><span style="color:#56B6C2;">&amp;</span><span style="color:#ABB2BF;">_mycategory;</span></span>
<span class="line"><span style="color:#ABB2BF;">};</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-c++ line-numbers-mode" data-ext="c++"><pre class="shiki one-dark-pro" style="background-color:#282c34;" tabindex="0"><code><span class="line"><span style="color:#C678DD;">#include</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&quot;Logger.h&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E5C07B;">Logger</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">*</span><span style="color:#E5C07B;">Logger</span><span style="color:#ABB2BF;">::</span><span style="color:#61AFEF;">getInstance</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">const</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">char</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">*</span><span style="color:#E06C75;font-style:italic;">fileName</span><span style="color:#ABB2BF;"> )</span></span>
<span class="line"><span style="color:#ABB2BF;">{</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#C678DD;">static</span><span style="color:#ABB2BF;"> Logger </span><span style="color:#61AFEF;">logger</span><span style="color:#ABB2BF;">(fileName);</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    // 注册destroy函数，在进程结束的时候执行，从而自动回收单例</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#61AFEF;">atexit</span><span style="color:#ABB2BF;">(Logger::destroy);</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#C678DD;">return</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">&amp;</span><span style="color:#ABB2BF;">logger;</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"><span style="color:#C678DD;">void</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">Logger</span><span style="color:#ABB2BF;">::</span><span style="color:#61AFEF;">destroy</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">{</span></span>
<span class="line"><span style="color:#ABB2BF;">    Category::</span><span style="color:#61AFEF;">shutdown</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E5C07B;">Logger</span><span style="color:#ABB2BF;">::</span><span style="color:#61AFEF;">Logger</span><span style="color:#ABB2BF;">(string fileName)</span></span>
<span class="line"><span style="color:#ABB2BF;">    : </span><span style="color:#61AFEF;">_ptnLayout1</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">new</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">PatternLayout</span><span style="color:#ABB2BF;">())</span></span>
<span class="line"><span style="color:#ABB2BF;">    , </span><span style="color:#61AFEF;">_ptnLayout2</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">new</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">PatternLayout</span><span style="color:#ABB2BF;">())</span></span>
<span class="line"><span style="color:#ABB2BF;">    , </span><span style="color:#61AFEF;">_osAppender</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">new</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">OstreamAppender</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;osAppender&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#56B6C2;">&amp;</span><span style="color:#ABB2BF;">cout))</span></span>
<span class="line"><span style="color:#ABB2BF;">    , </span><span style="color:#61AFEF;">_rfAppender</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">new</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">RollingFileAppender</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;fAppender&quot;</span><span style="color:#ABB2BF;">, fileName, </span><span style="color:#D19A66;">5</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">*</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">1024</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">3</span><span style="color:#ABB2BF;">))</span></span>
<span class="line"><span style="color:#ABB2BF;">    , </span><span style="color:#61AFEF;">_mycategory</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">Category</span><span style="color:#ABB2BF;">::</span><span style="color:#61AFEF;">getRoot</span><span style="color:#ABB2BF;">().</span><span style="color:#61AFEF;">getInstance</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;myCategory&quot;</span><span style="color:#ABB2BF;">))</span></span>
<span class="line"><span style="color:#ABB2BF;">{</span></span>
<span class="line"><span style="color:#ABB2BF;">    cout </span><span style="color:#C678DD;">&lt;&lt;</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&quot;Logger()&quot;</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">&lt;&lt;</span><span style="color:#ABB2BF;"> endl;</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E5C07B;">_ptnLayout1</span><span style="color:#ABB2BF;">-&gt;</span><span style="color:#61AFEF;">setConversionPattern</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;</span><span style="color:#D19A66;">%d</span><span style="color:#98C379;"> [</span><span style="color:#D19A66;">%p</span><span style="color:#98C379;">] %m</span><span style="color:#D19A66;">%n</span><span style="color:#98C379;">&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E5C07B;">_ptnLayout2</span><span style="color:#ABB2BF;">-&gt;</span><span style="color:#61AFEF;">setConversionPattern</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;</span><span style="color:#D19A66;">%d</span><span style="color:#98C379;"> [</span><span style="color:#D19A66;">%p</span><span style="color:#98C379;">] %m</span><span style="color:#D19A66;">%n</span><span style="color:#98C379;">&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E5C07B;">_osAppender</span><span style="color:#ABB2BF;">-&gt;</span><span style="color:#61AFEF;">setLayout</span><span style="color:#ABB2BF;">(_ptnLayout1);</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E5C07B;">_rfAppender</span><span style="color:#ABB2BF;">-&gt;</span><span style="color:#61AFEF;">setLayout</span><span style="color:#ABB2BF;">(_ptnLayout2);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E5C07B;">_mycategory</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">setPriority</span><span style="color:#ABB2BF;">(Priority::DEBUG);</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E5C07B;">_mycategory</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">addAppender</span><span style="color:#ABB2BF;">(_osAppender);</span><span style="color:#7F848E;font-style:italic;"> // 设置同时存入文件和屏幕显示</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E5C07B;">_mycategory</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">addAppender</span><span style="color:#ABB2BF;">(_rfAppender);</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">Logger::</span><span style="color:#56B6C2;">~</span><span style="color:#61AFEF;">Logger</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">{</span></span>
<span class="line"><span style="color:#ABB2BF;">    cout </span><span style="color:#C678DD;">&lt;&lt;</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&quot;~Logger()&quot;</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">&lt;&lt;</span><span style="color:#ABB2BF;"> endl;</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">void</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">Logger</span><span style="color:#ABB2BF;">::</span><span style="color:#61AFEF;">warn</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">const</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">char</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">*</span><span style="color:#E06C75;font-style:italic;">msg</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">{</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E5C07B;">_mycategory</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">warn</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;</span><span style="color:#D19A66;">%s</span><span style="color:#98C379;">&quot;</span><span style="color:#ABB2BF;">, msg);</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">void</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">Logger</span><span style="color:#ABB2BF;">::</span><span style="color:#61AFEF;">warn</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">const</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">char</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">*</span><span style="color:#E06C75;font-style:italic;">msg</span><span style="color:#ABB2BF;">, </span><span style="color:#C678DD;">const</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">char</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">*</span><span style="color:#E06C75;font-style:italic;">file</span><span style="color:#ABB2BF;">, </span><span style="color:#C678DD;">const</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">char</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">*</span><span style="color:#E06C75;font-style:italic;">func</span><span style="color:#ABB2BF;">, </span><span style="color:#C678DD;">int</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;font-style:italic;">line</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">{</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E5C07B;">_mycategory</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">warn</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;</span><span style="color:#D19A66;">%s</span><span style="color:#98C379;">@</span><span style="color:#D19A66;">%s</span><span style="color:#98C379;">,</span><span style="color:#D19A66;">%d</span><span style="color:#98C379;"> : </span><span style="color:#D19A66;">%s</span><span style="color:#98C379;">&quot;</span><span style="color:#ABB2BF;">, func, file, line, msg);</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">void</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">Logger</span><span style="color:#ABB2BF;">::</span><span style="color:#61AFEF;">error</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">const</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">char</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">*</span><span style="color:#E06C75;font-style:italic;">msg</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">{</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E5C07B;">_mycategory</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">error</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;</span><span style="color:#D19A66;">%s</span><span style="color:#98C379;">&quot;</span><span style="color:#ABB2BF;">, msg);</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">void</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">Logger</span><span style="color:#ABB2BF;">::</span><span style="color:#61AFEF;">error</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">const</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">char</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">*</span><span style="color:#E06C75;font-style:italic;">msg</span><span style="color:#ABB2BF;">, </span><span style="color:#C678DD;">const</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">char</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">*</span><span style="color:#E06C75;font-style:italic;">file</span><span style="color:#ABB2BF;">, </span><span style="color:#C678DD;">const</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">char</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">*</span><span style="color:#E06C75;font-style:italic;">func</span><span style="color:#ABB2BF;">, </span><span style="color:#C678DD;">int</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;font-style:italic;">line</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">{</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E5C07B;">_mycategory</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">error</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;</span><span style="color:#D19A66;">%s</span><span style="color:#98C379;">@</span><span style="color:#D19A66;">%s</span><span style="color:#98C379;">,</span><span style="color:#D19A66;">%d</span><span style="color:#98C379;"> : </span><span style="color:#D19A66;">%s</span><span style="color:#98C379;">&quot;</span><span style="color:#ABB2BF;">, func, file, line, msg);</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">void</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">Logger</span><span style="color:#ABB2BF;">::</span><span style="color:#61AFEF;">debug</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">const</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">char</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">*</span><span style="color:#E06C75;font-style:italic;">msg</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">{</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E5C07B;">_mycategory</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">debug</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;</span><span style="color:#D19A66;">%s</span><span style="color:#98C379;">&quot;</span><span style="color:#ABB2BF;">, msg);</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">void</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">Logger</span><span style="color:#ABB2BF;">::</span><span style="color:#61AFEF;">debug</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">const</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">char</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">*</span><span style="color:#E06C75;font-style:italic;">msg</span><span style="color:#ABB2BF;">, </span><span style="color:#C678DD;">const</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">char</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">*</span><span style="color:#E06C75;font-style:italic;">file</span><span style="color:#ABB2BF;">, </span><span style="color:#C678DD;">const</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">char</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">*</span><span style="color:#E06C75;font-style:italic;">func</span><span style="color:#ABB2BF;">, </span><span style="color:#C678DD;">int</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;font-style:italic;">line</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">{</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E5C07B;">_mycategory</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">debug</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;</span><span style="color:#D19A66;">%s</span><span style="color:#98C379;">@</span><span style="color:#D19A66;">%s</span><span style="color:#98C379;">,</span><span style="color:#D19A66;">%d</span><span style="color:#98C379;"> : </span><span style="color:#D19A66;">%s</span><span style="color:#98C379;">&quot;</span><span style="color:#ABB2BF;">, func, file, line, msg);</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">void</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">Logger</span><span style="color:#ABB2BF;">::</span><span style="color:#61AFEF;">info</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">const</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">char</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">*</span><span style="color:#E06C75;font-style:italic;">msg</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">{</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E5C07B;">_mycategory</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">info</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;</span><span style="color:#D19A66;">%s</span><span style="color:#98C379;">&quot;</span><span style="color:#ABB2BF;">, msg);</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">void</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">Logger</span><span style="color:#ABB2BF;">::</span><span style="color:#61AFEF;">info</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">const</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">char</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">*</span><span style="color:#E06C75;font-style:italic;">msg</span><span style="color:#ABB2BF;">, </span><span style="color:#C678DD;">const</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">char</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">*</span><span style="color:#E06C75;font-style:italic;">file</span><span style="color:#ABB2BF;">, </span><span style="color:#C678DD;">const</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">char</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">*</span><span style="color:#E06C75;font-style:italic;">func</span><span style="color:#ABB2BF;">, </span><span style="color:#C678DD;">int</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;font-style:italic;">line</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">{</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E5C07B;">_mycategory</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">info</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;</span><span style="color:#D19A66;">%s</span><span style="color:#98C379;">@</span><span style="color:#D19A66;">%s</span><span style="color:#98C379;">,</span><span style="color:#D19A66;">%d</span><span style="color:#98C379;"> : </span><span style="color:#D19A66;">%s</span><span style="color:#98C379;">&quot;</span><span style="color:#ABB2BF;">, func, file, line, msg);</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-c++ line-numbers-mode" data-ext="c++"><pre class="shiki one-dark-pro" style="background-color:#282c34;" tabindex="0"><code><span class="line"><span style="color:#C678DD;">#include</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&quot;Logger.h&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">int</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">main</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">{</span></span>
<span class="line"><span style="color:#ABB2BF;">    Logger </span><span style="color:#56B6C2;">*</span><span style="color:#ABB2BF;"> log </span><span style="color:#C678DD;">=</span><span style="color:#ABB2BF;"> Logger::</span><span style="color:#61AFEF;">getInstance</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E5C07B;">log</span><span style="color:#ABB2BF;">-&gt;</span><span style="color:#61AFEF;">warn</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;This is warn msg!&quot;</span><span style="color:#ABB2BF;">, __FILE__, __FUNCTION__, __LINE__);</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E5C07B;">log</span><span style="color:#ABB2BF;">-&gt;</span><span style="color:#61AFEF;">error</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;This is error msg!&quot;</span><span style="color:#ABB2BF;">, __FILE__, __FUNCTION__, __LINE__);</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E5C07B;">log</span><span style="color:#ABB2BF;">-&gt;</span><span style="color:#61AFEF;">debug</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;This is debug msg!&quot;</span><span style="color:#ABB2BF;">, __FILE__, __FUNCTION__, __LINE__);</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E5C07B;">log</span><span style="color:#ABB2BF;">-&gt;</span><span style="color:#61AFEF;">info</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;This is info msg!&quot;</span><span style="color:#ABB2BF;">, __FILE__, __FUNCTION__, __LINE__);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E5C07B;">log</span><span style="color:#ABB2BF;">-&gt;</span><span style="color:#61AFEF;">warn</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;This is warn msg!&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E5C07B;">log</span><span style="color:#ABB2BF;">-&gt;</span><span style="color:#61AFEF;">error</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;This is error msg!&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E5C07B;">log</span><span style="color:#ABB2BF;">-&gt;</span><span style="color:#61AFEF;">debug</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;This is debug msg!&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E5C07B;">log</span><span style="color:#ABB2BF;">-&gt;</span><span style="color:#61AFEF;">info</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;This is info msg!&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    //Logger::destory();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#C678DD;">return</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="shiki one-dark-pro" style="background-color:#282c34;" tabindex="0"><code><span class="line"><span style="color:#61AFEF;">$./a.out</span><span style="color:#ABB2BF;"> </span></span>
<span class="line"><span style="color:#61AFEF;">Logger</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">2024-04-11 23:03:02,056 [WARN] main@test.cc,6 : This is warn msg!</span></span>
<span class="line"><span style="color:#ABB2BF;">2024-04-11 23:03:02,057 [ERROR] main@test.cc,7 : This is error msg!</span></span>
<span class="line"><span style="color:#ABB2BF;">2024-04-11 23:03:02,057 [DEBUG] main@test.cc,8 : This is debug msg!</span></span>
<span class="line"><span style="color:#ABB2BF;">2024-04-11 23:03:02,057 [INFO] main@test.cc,9 : This is info msg!</span></span>
<span class="line"><span style="color:#ABB2BF;">2024-04-11 23:03:02,058 [WARN] This is warn msg!</span></span>
<span class="line"><span style="color:#ABB2BF;">2024-04-11 23:03:02,058 [ERROR] This is error msg!</span></span>
<span class="line"><span style="color:#ABB2BF;">2024-04-11 23:03:02,059 [DEBUG] This is debug msg!</span></span>
<span class="line"><span style="color:#ABB2BF;">2024-04-11 23:03:02,059 [INFO] This is info msg!</span></span>
<span class="line"><span style="color:#ABB2BF;">~Logger()</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,12);function U(G,M){const e=c("ExternalLinkIcon"),l=c("font");return r(),B("div",null,[A,n("p",null,[s("log4cpp开发文档："),n("a",u,[s("Main Page (sourceforge.net)"),a(e)])]),v,n("p",null,[s("Log4cpp的主页为："),n("a",C,[s("Log library for C++ download | SourceForge.net"),a(e)])]),D,n("p",null,[s("log4cpp从大的结构上分为"),a(l,{color:"green"},{default:p(()=>[m]),_:1}),s(","),n("strong",null,[a(l,{color:"green"},{default:p(()=>[s("日志追加器(Appender),日志布局（Layout),日志级别(Priority)")]),_:1})]),s("。除此以外还提供了一些帮助类，简化我们对日志的代码设置。")]),g,n("p",null,[s("Category，日志输出主体类，提供了输出各种"),b,s("的方法，并且能够设置类别优先级，"),E,s("，"),n("u",null,[a(l,{color:"green"},{default:p(()=>[h]),_:1}),s("，其他分类都是root分类的子分类，有点类似于java的单继承结构，子分类的输出同时会输出到父分类中")]),s("。")]),f,n("p",null,[s("Appender，主要是用来确定日志输出行为，例如"),a(l,{color:"red"},{default:p(()=>[_]),_:1}),s("。类Appender是由Category来加载的，"),a(l,{color:"green"},{default:p(()=>[q]),_:1}),s("，一个Appender也可以被多个Category加载，但是有些Appender类没有设置互斥，日志的多线程支持主要是在Category里做的处理，因此不要使用一个Appender加载到多个Category中。")]),L,n("p",null,[s("“"),a(l,{color:"red"},{default:p(()=>[s("在调试多线程程序时，不能随意使用printf")]),_:1}),s("”。"),x,s("。所以"),a(l,{color:"green"},{default:p(()=>[k]),_:1}),s("。StringQueueAppender的功能是将日志记录到一个字符串队列中，该字符串队列使用了STL中的两个容器，即字符串容器"),P,s("和队列容器"),w,s("，具体如下：")]),T,n("h4",R,[O,s(),n("strong",null,[a(l,{color:"red"},{default:p(()=>[s("Log4cpp记录日志的原理")]),_:1})])]),n("p",null,[n("strong",null,[a(l,{color:"green"},{default:p(()=>[s("每个Category都有一个优先级，该优先级可以由setPriority方法设置，或者从其父Category中继承而来。每条日志也有一个优先级(每个Appender也可以设置其threshold)，当Category记录该条日志时，若日志优先级高于Category的优先级时，该日志被记录，否则被忽略")]),_:1})]),s("。")]),N,a(l,{color:"red"},{default:p(()=>[s("**Ø 不要手动释放Category、Appender和Layout**")]),_:1}),s(";"),a(l,{color:"red"},{default:p(()=>[s("**Ø 同一个Appender不要加入多个Category，否则它会被释放多次从而导致程序崩溃**")]),_:1}),s(";"),a(l,{color:"red"},{default:p(()=>[s("**Ø 同一个Layout不要附着到多个Appender上，否则也会被释放多次导致程序崩溃**")]),_:1}),s(";"),S,n("p",null,[s("运行时，如若提示缺少log4cpp库文件，表示"),a(l,{color:"red"},{default:p(()=>[I]),_:1}),s("，需要进行以下设置")]),Q])}const H=t(F,[["render",U],["__file","log4cpp.html.vue"]]);export{H as default};
